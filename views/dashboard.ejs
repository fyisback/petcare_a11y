<div class="table-responsive">
    <table id="projects-table" class="table table-striped table-hover">
        <thead class="thead-dark">
            <tr>
                <th scope="col" data-column="0" data-sort-type="text">Project Title / URL</th>
                <th scope="col" data-column="1" data-sort-type="score">Score</th>
                
                <th scope="col" data-column="2" data-sort-type="number" style="text-align: center;">Total</th>
                <th scope="col" data-column="3" data-sort-type="number" style="text-align: center;">Critical</th>
                <th scope="col" data-column="4" data-sort-type="number" style="text-align: center;">Serious</th>
                <th scope="col" data-column="5" data-sort-type="number" style="text-align: center;">Moderate</th>
                
                <th scope="col">Scan Date</th>
                <th scope="col">Report</th>
                <th scope="col" data-column="8" data-sort-type="category">Category</th>
                <th scope="col">Details</th>
                <th scope="col">Status</th>
            </tr>
        </thead>
        <tbody>
            <% activeProjectsData.forEach(project => { %>
                <%
                    let cellStyle = '';
                    if (project.success && typeof project.scoreValue === 'number') {
                        if (project.scoreValue < 80) cellStyle = 'background-color: #dc3545; color: white;';
                        else if (project.scoreValue < 90) cellStyle = 'background-color: #ffc107; color: black;';
                        else cellStyle = 'background-color: #28a745; color: white;';
                    }
                %>
                <tr>
                    <td title="<%= project.project_url %>">
                        <strong><%= project.custom_title || project.project_url %></strong><br>
                        <a href="<%= project.project_url %>" target="_blank" style="font-size: 0.8em; color: #007bff;">Open Site</a>
                    </td>

                    <td style="<%= cellStyle %>; text-align: center; font-weight: bold;" data-score="<%= project.scoreValue %>">
                        <%= project.score %>
                    </td>

                    <td style="text-align: center; font-weight: bold;"><%= project.total %></td>

                    <td style="text-align: center; color: #dc3545; font-weight: bold;"><%= project.critical %></td>

                    <td style="text-align: center; color: #fd7e14; font-weight: bold;"><%= project.serious %></td>

                    <td style="text-align: center;"><%= project.moderate %></td>

                    <td style="font-size: 0.85rem;"><%= project.scanDate %></td>

                    <td style="text-align: center;"><%- project.reportButton %></td>

                    <td><%= project.category %></td>

                    <td style="text-align: center;">
                        <a href="/project/<%= project.id %>/score-history"><button class="btn btn-sm btn-secondary">Details</button></a>
                    </td>

                    <td><%= project.status %></td>
                </tr>
            <% }) %>
        </tbody>
    </table>
</div>